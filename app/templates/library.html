{% extends "layout.html" %}
<!>
{% block head %}
<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- DataTables -->
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.16/js/jquery.dataTables.js"></script>
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.16/css/jquery.dataTables.min.css">
<!-- Custom -->
<script src="{{ url_for('static', filename='library.js') }}"></script>
<!>
{{ super() }} {% endblock %}
<!>
{% block content %}

<header>
    <a href="/logout" class="logout">Logout</a>
    <h1>Search Mendeley</h1>
    <img src="{{ url_for('static', filename='SearchMendeley-white.png') }}">
</header>

<nav>
    <form action="/library" method="GET">
        <input id='simSearch' type="search" name="query" placeholder="Search..." value="{{query}}" {% if advancedSearch %} hidden {% endif %}>
        <div id='advSearch' {% if not advancedSearch %} class='hidden' {% endif %}>
            <input type="search" name="titleQuery" placeholder="Search By Title..." value="{{titleQuery}}">
            <input type="search" name="authorQuery" placeholder="Search By Author..." value="{{authorQuery}}">
            <input type="search" name="sourceQuery" placeholder="Search By Source..." value="{{sourceQuery}}">
            <input type="search" name="abstractQuery" placeholder="Search Abstracts..." value="{{abstractQuery}}">
        </div>
        <input type="search" name="noteQuery" placeholder="Search Annotations..." value="{{noteQuery}}">
        <label for="advancedSearchToggle">
            <input id="advancedSearchToggle" type="checkbox" name="advancedSearch" {% if advancedSearch %} checked {% endif %} onclick="toggleAdvSearch();">Advanced Search</input>
        </label>
        <input type="submit" class="hidden">
        <input type="reset" onclick="form.reset(); toggleAdvSearch();">
    </form>
</nav>

<table id="libTable" class="display">
    <thead>
        <th>Title</th>
        <th>Year</th>
        <th>Added</th>
        <th>File</th>
    </thead>
    <tbody>
        {% for doc in docs %}
        <tr>
            <td>
                <a href="/document?document_id={{doc['id']}}" target="_blank">{{doc.title}}</a>
            </td>

            <td>
                {% if doc.year %}
                <time>{{doc.year}}</time>
                {% endif %}
            </td>

            <td class="datetime">
                {% if doc.created %}
                <time datetime="{{doc.created}}">{{doc.created.strftime('%d/%m/%Y %H:%M')}}</time>
                {% endif %}
            </td>

            <td>
                {% if doc.file_attached %}
                <a href="/download?document_id={{doc['id']}}">Download</a>
                {% endif %}
            </td>

        </tr>
        {% endfor %}
    </tbody>
</table>

<footer>
    <form action="/detailsLookup" method="GET">
        DOI lookup:
        <input type="text" name="doi">
        <input type="submit" class="hidden">
    </form>
</footer>
<!>
{% endblock %}